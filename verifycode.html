<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>登录</title>
  <meta content="noarchive" name="robots">
  <meta content="webkit" name="renderer">
  <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
  <link href="http://cdn.tigerapi.net/favicon.ico" rel="shortcut icon">
  <link href="http://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" rel="stylesheet">
  <link href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <link href="http://cdnjs.cloudflare.com/ajax/libs/admin-lte/2.4.18/css/AdminLTE.min.css" rel="stylesheet">
</head>
<body class="hold-transition login-page bg-black">
  <div class="login-box">
    <div class="login-logo">
      <a href="#" class="text-gray">
        <img class="img-responsive center-block" style="max-height: 50px" src="http://cdn.tigerapi.net/logo.svg">
      </a>
    </div>
    <div class="login-box-body box">
      <p class="login-box-msg">发送短信</p>
      <form class="box-body" method="post">
        <div class="form-group has-feedback">
          <select class="form-control" name="type">
            <option selected>UnbindGAKeyVerifyCode</option>
            <option>ResetPasswordVerifyCode</option>
            <option>BindGAKeyVerifyCode</option>
            <option>RegisterVerifyCode</option>
          </select>
        </div>
        <div class="form-group has-feedback">
          <input name="phone" type="test" class="form-control" autocomplete="off" placeholder="Email" data-rule="{'messages':{'required':'登录名称不能为空'}}" value="+86 15910769255" required>
          <span class="glyphicon glyphicon-envelope form-control-feedback"></span>
        </div>
        <div class="form-group has-feedback">
          <div class="input-group">
            <input name="code" type="text" class="form-control" placeholder="验证码" data-rule="{'messages':{'required':'请输入验证码'}}" data-target=".input-group" required>
            <span class="input-group-btn">
              <button class="btn btn-default" type="button" id="codeTrigger">获取验证码</button>
            </span>
          </div>
        </div>
      </form>
    </div>
  </div>
  <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
  <script src="http://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js"></script>
  <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery.form/4.2.2/jquery.form.min.js"></script>
  <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery-backstretch/2.0.4/jquery.backstretch.min.js"></script>
  <script src="http://cdnjs.cloudflare.com/ajax/libs/blueimp-md5/2.10.0/js/md5.min.js"></script>
  <script src="https://static.geetest.com/static/tools/gt.js"></script>

  <script type="text/javascript">
    var handler = function (init) {

      $(document).on('click', '#codeTrigger', function (e) {
        e.preventDefault();
        init.verify();
      });

      init.onSuccess(function () {
        $.ajax({
          method: 'post', dataType: 'json',
          url: 'https://test-api.bbx.com/v1/ifaccount/verifyCode?' + $('form').formSerialize(),
          contentType: "application/json",
          data: JSON.stringify(init.getValidate()),
          headers: {
            'Bbx-Language': 'zh-cn',
            'Bbx-Dev': 'web',
            'Bbx-Ver': '1.0'
          },
          success: function (resp) {
            if (resp.errno != 'OK') {
              alert(resp.message);
              return;
            }

            var timeout = 90, btn = $('#codeTrigger').attr('disabled', true).text(timeout + ' s'),
              count = setInterval(function () {
                if (--timeout > 0)
                  return btn.text(timeout + ' s')
                clearInterval(count);
                btn.text('获取验证码').attr('disabled', false);
              }, 1000);
          }
        })
      });
    };

    $(document).ready(function () {
      $.backstretch('https://admin.22ssyl.com/bingpic');

      $.getJSON('https://test-api.bbx.com/v1/ifaccount/captchCheck?action=login', function (resp) {
        var data = resp.data.register;
        initGeetest({
          gt: "62d5b06ee45eb2339479b846ee999cfb",
          challenge: "4ed003fd3c743d96c38fca8544819120",
          new_captcha: true,
          offline: 0,
          product: "bind",
        }, handler);
      })
    })
  </script>
</body>
</html>